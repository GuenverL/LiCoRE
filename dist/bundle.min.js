$("#btnExport").click(function(){for(var e='<?xml version = "1.0" encoding="UTF-8" standalone="yes" ?>\n<arbre>\n',n=0,o=competencesValidees.length;o>n;++n){var c=competencesValidees[n];e+="  <competence>\n       <id>"+c.idCompetence+"</id>\n       <nom>"+c.nomCompetence+"</nom>\n       <idPere>"+c.idPereCompetence+"</idPere>\n"}e+="</arbre>",$("#linkXML").click(function(){this.href="data:application/xml;charset=utf-8,"+encodeURIComponent(e)})});
function genererBoutonGestion(e,n,t,o){"use strict";var i="";return i+="setCompetencesVisibles"===n||e.feuille&&"setCompetencesInvisibles"===n?' <span id="competence-'+e.idCompetence+'-button-visibilite" data-toggle="modal"':' <span data-toggle="modal" data-target="#genericModal" data-type="'+n+'" data-id-competence="'+e.idCompetence+'" data-nom-competence="'+e.nomCompetence+'"',i+=' data-placement="top" data-original-title="'+t+'" class="glyphicon glyphicon-gestion cursor-pointer '+o+'" aria-hidden="true"></span>'}function genererLigneCompetenceGestion(e,n){"use strict";var t="";return t+='<li id="competence-'+e.idCompetence+'"',void 0===e.visible||e.visible||(t+=' class="couleur-grise"'),t+="display-none"===n?' style="display: none;">':">",t+='<a href="#">'+e.nomCompetence+"</a>",t+=genererBoutonGestion(e,"ajouterCompetence","Ajouter une compétence","glyphicon-plus couleur-verte"),t+=genererBoutonGestion(e,"ajouterPlusieursCompetences","Ajouter plusieurs compétences","glyphicon-th-list couleur-verte"),t+=genererBoutonGestion(e,"modifierCompetence","Modifier une compétence","glyphicon-pencil couleur-jaune"),t+=e.visible||void 0===e.visible?genererBoutonGestion(e,"setCompetencesInvisibles","Rendre la compétence invisible","glyphicon-eye-close couleur-bleue"):genererBoutonGestion(e,"setCompetencesVisibles","Rendre la compétence visible","glyphicon-eye-open couleur-bleue"),t+=genererBoutonGestion(e,"supprimerCompetence","Supprimer une compétence","glyphicon-remove couleur-rouge")}function genererListeCompetences(e,n,t,o){"use strict";var i="",c=0;n||c||(i+="\n<ul>\n");for(var r=0,s=t.length;s>r;++r){var l=t[r];if(e===l.idPereCompetence){if(n>c&&(i+="\n<ul>\n"),"gestionCompetences"===o){var u={idCompetence:l.idCompetence,nomCompetence:l.nomCompetence,visible:l.visible,feuille:l.feuille};i+=genererLigneCompetenceGestion(u,"display-normal")}else i+='<li id="competence-'+l.idCompetence+'"',i+="valide"===l.etat?' class="couleur-text-valide">':' class="couleur-text-lien">',i+='<a href="#">'+l.nomCompetence+"</a>";c=n,i+=genererListeCompetences(l.idCompetence,n+1,t,o)}}return i+=c===n&&0!==c?"</ul>\n</li>\n":c===n?"</ul>\n":"</li>\n"}function majArbre(e){"use strict";$(e).each(function(){$(this).treeview()})}
$("#genericModal").on("show.bs.modal",function(e){"use strict";var t=$("#buttonSubmit");$(this).removeData("modal"),t.off();var o=$(e.relatedTarget),a=o[0].dataset.idCompetence,n=o[0].dataset.nomCompetence,l=o[0].dataset.type,i=$(this),r=function(e){i.find(".modal-body #genericModalForm").empty(),i.find(".modal-title").text(e.title),i.find(".modal-body #genericModalForm").append(e.body),i.find(".modal-body #label").text(e.label),i.find(".modal-body #nomCompetence").val(e.nomCompetence)},c={};switch(l){case"ajouterCompetence":c.title='Ajouter une compétence à "'+n+'"',c.body='<div class="form-group"><label for="nom-competence" class="control-label" id="label"></label><input type="text" class="form-control" id="nomCompetence"></div>',c.label="Nom de la nouvelle compétence :",c.nomCompetence="";break;case"ajouterPlusieursCompetences":c.title='Ajouter des compétences à "'+n+'"',c.body='<div class="form-group"><label for="nom-competence" class="control-label" id="label"></label><textarea rows="20" class="form-control" id="nomCompetence"></textarea></div>',c.label="Nom des nouvelles compétences (séparées par un retour à la ligne) :",c.nomCompetence="";break;case"modifierCompetence":c.title='Modifier la compétence "'+n+'"',c.body='<div class="form-group"><label for="nom-competence" class="control-label" id="label"></label><input type="text" class="form-control" id="nomCompetence"></div>',c.label="Nom :",c.nomCompetence=n;break;case"supprimerCompetence":var s=o.data("feuille");c.label="",c.nomCompetence=n,s?(c.title='Supprimer la compétence "'+n+'"',c.body='<div class="alert alert-danger" role="alert"><strong>Attention!</strong><p>Voulez-vous vraiment continuer et supprimer cette compétence ?</p></div>'):(c.title='Supprimer la catégorie "'+n+'" et ses sous-compétences',c.body='<div class="alert alert-danger" role="alert"><strong>Attention!</strong><p>La suppression de cette catégorie entrainera la suppression de toutes ses sous-catégories et compétences.</p><p>Voulez-vous vraiment continuer et supprimer cette catégorie ?</p></div>');break;case"setCompetencesInvisibles":c.label="",c.nomCompetence=n,c.title='Rendre invisible la catégorie "'+n+'" et ses sous-compétences',c.body='<div class="alert alert-warning" role="alert"><strong>Attention!</strong><p>Rendre invisible cette catégorie va mettre invisible toutes ses sous-catégories et compétences.</p><p>Voulez-vous vraiment continuer et rendre invisible cette catégorie ?</p></div>';break;case"validerCompetence":c.body="",$.getJSON("api/competences.php",{type:"getExplications",idCompetence:a},function(e){e.explicationTuteur&&(c.body='<div class="panel panel-default"><div class="panel-heading"><h3 class="panel-title">Explications du tuteur concernant le refus de validation de cette compétence</h3></div><div class="panel-body">'+e.explicationTuteur+"</div></div>"),c.label="Explications pour justifier la validation de cette compétence (facultatif mais vivement recommandé) :",c.nomCompetence=n,c.title='Validation de la compétence "'+n+'"',c.body+='<div class="alert alert-warning" role="alert"><strong>Attention!</strong><p>Vous allez valider une compétence et celle ci sera donc mise en attente de validation par un tuteur. Voulez vous continuer ?</p></div><div class="form-group"><label for="explications-validation" class="control-label" id="label"></label><textarea rows="10" class="form-control" id="explicationsValidation"></textarea></div>',r(c),e.explicationUtilisateur&&$("#explicationsValidation").val(e.explicationUtilisateur)});break;case"invaliderCompetence":c.label="",c.nomCompetence=n,c.title='Invalidation de la compétence "'+n+'"',c.body='<div class="alert alert-warning" role="alert"><strong>Attention!</strong><p>Vous allez invalider une compétence et celle ci sera donc retiré de votre liste de compétences validées. Voulez vous continuer ?</p></div>';break;case"invaliderCompetenceTemporaire":c.label="",c.nomCompetence=n,c.title='Invalidation de la compétence "'+n+'"',c.body='<div class="alert alert-warning" role="alert"><strong>Attention!</strong><p>Vous allez retirer une compétence actuellement en attente de validation par un tuteur. Voulez vous continuer ?</p></div>';break;case"invalidationCompetencesUtilisateurs":var p=o[0].dataset.nomUtilisateur;c.label="",c.nomCompetence="",c.title='Invalider la compétence "'+n+'" pour "'+p+'"',c.body='<div class="alert alert-warning" role="alert"><strong>Attention!</strong><p>Vous allez invalider cette compétence pour '+p+". Voulez vous continuer ?</p></div>"}r(c);var d={};"validerCompetence"===l||"invaliderCompetence"===l||"invaliderCompetenceTemporaire"===l?(d={idCompetence:a,nomCompetence:n,type:l},t.click(d,buttonSubmitValidation)):(d={idCompetence:a,type:l},t.click(d,buttonSubmitGestionCompetences))});
function setCompetencesVisibilite(e,t){"use strict";for(var n=0,o=e.length;o>n;++n){var c=e[n];if("setCompetencesInvisibles"===t){$("#competence-"+c.idCompetence).addClass("couleur-grise"),$("#competence-"+c.idCompetence).find("span.glyphicon-eye-close").remove(),$("#competence-"+c.idCompetence).find("span.glyphicon-eye-open").remove(),$("#competence-"+c.idCompetence).find("span.glyphicon-pencil").after(genererBoutonGestion(c,"setCompetencesVisibles","Rendre la compétence visible","glyphicon-eye-open couleur-bleue"));var i={idCompetence:c.idCompetence,nomCompetence:c.nomCompetence,visibilite:"setCompetencesVisibles"};$("#competence-"+c.idCompetence+"-button-visibilite").off(),$("#competence-"+c.idCompetence+"-button-visibilite").click(i,setCompetencesVisibiliteOnClick)}else $("#competence-"+c.idCompetence).toggleClass("couleur-grise"),$("#competence-"+c.idCompetence).find("span.glyphicon-eye-open").first().remove(),$("#competence-"+c.idCompetence).find("span.glyphicon-pencil").first().after(genererBoutonGestion(c,"setCompetencesInvisibles","Rendre la compétence invisible","glyphicon-eye-close couleur-bleue")),$("#competence-"+c.idCompetence+"-button-visibilite").off()}}function setCompetencesVisibiliteOnClick(e){"use strict";var t=e.data.idCompetence,n=e.data.visibilite;$.getJSON("api/competences.php",{type:n,idCompetence:t}).always(function(e){$(".tooltip").remove(),setCompetencesVisibilite(e,n),$('[data-toggle="modal"]').tooltip()})}function majButtons(e){"use strict";$buttonSelectionne.removeClass("active"),e.addClass("active"),$buttonSelectionne=e}function majArbreGestionCompetences(e,t){"use strict";var n=$(e);typeAffichageCompetences=t,$buttonSelectionne.selector!==n.selector&&(majButtons(n),$("#arbreGestionCompetences").empty(),$("#arbreGestionCompetences").hide(),$("#loader-competences").show(),$.getJSON("api/competences.php",{type:t}).always(function(e){""!==e.responseText&&($("#arbreGestionCompetences").append('<li id="listeCompetences"><a href="#">Liste des compétences</a>'),$("#listeCompetences").append(genererListeCompetences(0,0,e,"gestionCompetences")),majArbre("#arbreGestionCompetences"),$('[data-toggle="modal"]').tooltip(),$("#loader-competences").hide(),$("#arbreGestionCompetences").show())}))}function buttonSubmitGestionCompetences(e){"use strict";var t=e.data.idCompetence,n=e.data.type,o=$("#genericModal").find(".modal-body #nomCompetence").val();$.getJSON("api/competences.php",{type:n,idCompetence:t,nomCompetence:o}).always(function(e){if(e){var c=function(e){var n=$("#competence-"+t).find("ul").length,o=$("#competence-"+t).find("i").hasClass("glyphicon-chevron-down");0===n&&$("#competence-"+t).append("<ul>");for(var c=0,i=e.length;i>c;++c){var s=e[c];-1!==s.idCompetence&&(o?$("#competence-"+t).find("ul").first().append(genererLigneCompetenceGestion(s,"display-normal")):$("#competence-"+t).find("ul").first().append(genererLigneCompetenceGestion(s,"display-none")))}0===n&&($("#competence-"+t).append("</ul>"),actualiserBranche($("#competence-"+t)),$("#competence-"+t).find("i").removeClass("glyphicon-chevron-right"),$("#competence-"+t).find("i").addClass("glyphicon-chevron-down"))};switch(n){case"ajouterCompetence":-1!==e.idCompetence&&c([e]);break;case"ajouterPlusieursCompetences":c(e);break;case"modifierCompetence":e.retour&&($("#competence-"+t).find("span.glyphicon-plus").first().attr("data-nom-competence",o),$("#competence-"+t).find("span.glyphicon-th-list").first().attr("data-nom-competence",o),$("#competence-"+t).find("span.glyphicon-pencil").first().attr("data-nom-competence",o),$("#competence-"+t).find("span.glyphicon-eye-close").first().attr("data-nom-competence",o),$("#competence-"+t).find("span.glyphicon-eye-open").first().attr("data-nom-competence",o),$("#competence-"+t).find("span.glyphicon-remove").first().attr("data-nom-competence",o),$("#competence-"+t).find("a").first().empty(),$("#competence-"+t).find("a").first().append(o));break;case"setCompetencesInvisibles":setCompetencesVisibilite(e,"setCompetencesInvisibles");break;case"supprimerCompetence":$("#competence-"+t).remove();break;default:$.getJSON("api/competences.php",{type:typeAffichageCompetences}).always(function(e){$("#arbreGestionCompetences").empty(),$("#arbreGestionCompetences").append('<li id="listeCompetences"><a href="#">Liste des compétences</a>'),$("#listeCompetences").append(genererListeCompetences(0,0,e,"gestionCompetences")),majArbre("#arbreGestionCompetences"),$('[data-toggle="modal"]').tooltip()})}}})}var $buttonSelectionne=$("#buttonToutesCompetences"),typeAffichageCompetences="getToutesLesCompetences";$("#buttonToutesCompetences").click(function(){"use strict";majArbreGestionCompetences("#buttonToutesCompetences","getToutesLesCompetences")}),$("#buttonCompetencesVisibles").click(function(){"use strict";majArbreGestionCompetences("#buttonCompetencesVisibles","getCompetencesVisibles")}),$("#buttonCompetencesInvisibles").click(function(){"use strict";majArbreGestionCompetences("#buttonCompetencesInvisibles","getCompetencesInvisibles")});
function actualiserBranche(i){"use strict";i.prepend('<i class="tree-indicator glyphicon glyphicon-chevron-right"></i>'),i.addClass("tree-branch"),i.on("click",function(i){if(this==i.target){var e=$(this).children("i:first");e.toggleClass("glyphicon-chevron-down glyphicon-chevron-right"),$(this).children().children().toggle()}}),i.children().children().toggle(),i.children(".tree-indicator, button, a").click(function(e){i.click(),e.preventDefault()})}$.fn.extend({treeview:function(){return this.each(function(){var i=$(this);i.addClass("treeview-tree"),i.find("li").each(function(){$(this)}),i.find("li").has("ul").each(function(){actualiserBranche($(this))})})}});
function genererListGroupItem(e,t,i,a,o,n){"use strict";var l,r,d="";return"validationCompetenceParTuteur"===i||"invalidationCompetencesUtilisateurs"===i?(l=e.idUtilisateur,r=e.prenomUtilisateur+" "+e.nomUtilisateur):(l=e.idCompetence,r=e.nomCompetence),d='<div id="list-group-item-'+l+'" class="list-group-item cursor-pointer '+t+'" data-toggle="modal" ',n?(d+="validationCompetenceParTuteur"===i?'data-target="#validationUtilisateursModal"':'data-target="#genericModal"',d+=' data-type="'+i+'" data-id-competence="'+e.idCompetence+'" data-nom-competence="'+e.nomCompetence):d+='data-target="#connexionModal"',"validationCompetenceParTuteur"===i&&(d+='" data-nom-utilisateur="'+r+'" data-id-utilisateur="'+l),d+='"><div class="media"><div class="media-body">'+r,"valide"===e.etat?d+='<div><hr class="separation-competence">Validée par '+e.prenomTuteur+" "+e.nomTuteur+" le "+e.dateValidation+"</div>":"invalide"===e.etat&&(d+='<div><hr class="separation-competence"><p>Validation refusée par '+e.prenomTuteur+" "+e.nomTuteur+" le "+e.dateValidation+"</p><p>Cliquez sur la compétence pour afficher l'explication</p></div>"),d+='</div><div class="media-right media-middle">',d+="validationCompetenceParTuteur"===i||"invalidationCompetencesUtilisateurs"===i?' <span id="utilisateur-':' <span id="competence-',d+=l+'" data-toggle="modal" data-placement="top" data-original-title="'+a+'" class="glyphicon cursor-pointer '+o+'" aria-hidden="true"></span></div></div>'}function buttonSubmitValidation(e){"use strict";var t,i,a=e.data.idCompetence,o=(e.data.nomCompetence,e.data.type);"accepterValidation"===o||"refuserValidation"===o?(t=e.data.idUtilisateur,i=$("#list-group-item-"+t)):i=$("#list-group-item-"+a),$(".tooltip").remove();var n=function(){i.removeAttr("data-target"),i.removeAttr("data-toggle"),i.removeAttr("data-original-title"),i.removeAttr("data-id-utilisateur"),i.removeAttr("data-nom-utilisateur"),i.removeAttr("data-id-competence"),i.removeAttr("data-nom-competence"),i.removeAttr("data-type"),i.removeAttr("title"),i.removeClass("cursor-pointer"),i.find("span.glyphicon").first().remove()};"validerCompetence"===o?($.getJSON("api/competences.php",{type:"validation",idCompetence:a,explications:$("#genericModal").find(".modal-body #explicationsValidation").val()}),i.attr("data-type","invaliderCompetenceTemporaire"),i.toggleClass("couleur-attente-bg"),i.removeClass("couleur-invalide-bg"),i.removeClass("couleur-text-invalide"),i.find("span.glyphicon").first().toggleClass("glyphicon-ok"),i.find("span.glyphicon").first().toggleClass("glyphicon-hourglass"),i.find("span.glyphicon-hourglass").first().attr("data-original-title","Compétence en attente de validation"),i.find("div.media-body").find("div").first().remove()):"invaliderCompetenceTemporaire"===o?($.getJSON("api/competences.php",{type:"invalidation",idCompetence:a}),i.attr("data-type","validerCompetence"),i.toggleClass("couleur-attente-bg"),i.find("span.glyphicon").first().toggleClass("glyphicon-ok"),i.find("span.glyphicon").first().toggleClass("glyphicon-hourglass"),i.find("span.glyphicon-ok").first().attr("data-original-title","Valider la compétence")):"invaliderCompetence"===o?($.getJSON("api/competences.php",{type:"invalidation",idCompetence:a}),i.attr("data-type","validerCompetence"),i.toggleClass("couleur-valide-bg"),i.find("span.glyphicon").first().toggleClass("glyphicon-ok"),i.find("span.glyphicon").first().toggleClass("glyphicon-remove"),i.find("span.glyphicon-ok").first().attr("data-original-title","Valider la compétence"),i.find("div.media-body").find("div").first().remove()):"accepterValidation"===o?($.getJSON("api/competences.php",{type:"accepterValidation",idCompetence:a,idUtilisateur:t}),n(),i.toggleClass("couleur-attente-bg"),i.toggleClass("couleur-valide-bg")):"refuserValidation"===o&&($.getJSON("api/competences.php",{type:"refuserValidation",idCompetence:a,idUtilisateur:t,explications:$("#validationUtilisateursModal").find(".modal-body #explicationsValidation").val()}),n(),i.toggleClass("couleur-attente-bg"),i.toggleClass("couleur-invalide-bg"),i.toggleClass("couleur-text-invalide"))}function afficherCompetence(e){"use strict";var t,i=e.data.idCompetence,a=e.data.nomCompetence,o=e.data.type;null!==$lienPrecedent&&($lienPrecedent.toggleClass("couleur-text-selection"),$lienPrecedent.toggleClass("couleur-text-lien")),$lienPrecedent=$("#competence-"+i),$lienPrecedent.toggleClass("couleur-text-lien"),$lienPrecedent.toggleClass("couleur-text-selection"),$.getJSON("api/competences.php",{type:"estConnecte"},function(e){t=e.estConnecte,"sousCompetences"===o?$.getJSON("api/competences.php",{type:"sousCompetences",idPere:i},function(e){$("#panel-body-competences").empty(),$("#panel-body-competences").append('<div class="list-group-item heading">'+a+'</div><div id="competences-a-valider" class="list-group"></div>');for(var i=0,o=e.length;o>i;++i){var n=e[i];"attente"===n.etat?$("#competences-a-valider").append(genererListGroupItem(n,"couleur-attente-bg","invaliderCompetenceTemporaire","Compétence en attente de validation","glyphicon-hourglass",t)):"valide"===n.etat?$("#competences-a-valider").append(genererListGroupItem(n,"couleur-valide-bg","invaliderCompetence","Invalider la compétence","glyphicon-remove",t)):"invalide"===n.etat?$("#competences-a-valider").append(genererListGroupItem(n,"couleur-invalide-bg couleur-text-invalide","validerCompetence","Valider la compétence","glyphicon-ok",t)):$("#competences-a-valider").append(genererListGroupItem(n,"","validerCompetence","Valider la compétence","glyphicon-ok",t))}$('[data-toggle="modal"]').tooltip()}).fail(function(e,t,i){console.error("getJSON failed, status: "+t+", error: "+i)}):$.getJSON("api/competences.php",{type:"getUtilisateursCompetence",idCompetence:i},function(e){$("#panel-body-etudiants").empty(),$("#panel-body-etudiants").append('<div class="list-group-item heading">'+a+'</div><div id="utilisateurs-a-valider" class="list-group"></div>');for(var t=0,o=e.length;o>t;++t){var n=e[t],l={idCompetence:i,nomCompetence:a,idUtilisateur:n.idUtilisateur,prenomUtilisateur:n.prenom,nomUtilisateur:n.nom};$("#utilisateurs-a-valider").append(genererListGroupItem(l,"couleur-attente-bg","validationCompetenceParTuteur","Valider l'étudiant","glyphicon-hourglass",!0))}$('[data-toggle="modal"]').tooltip()}).fail(function(e,t,i){console.error("getJSON failed, status: "+t+", error: "+i)})})}$("#validationUtilisateursModal").on("show.bs.modal",function(e){"use strict";var t=$("#buttonAccepter"),i=$("#buttonRefuser");$(this).removeData("modal"),t.off(),i.off();var a=$(e.relatedTarget),o=a[0].dataset.idCompetence,n=a[0].dataset.nomCompetence,l=a[0].dataset.idUtilisateur,r=a[0].dataset.nomUtilisateur,d=$(this);$.getJSON("api/competences.php",{type:"getExplicationsEtudiant",idCompetence:o,idUtilisateur:l},function(e){var t="";""!==e.explication&&(t+='<div class="panel panel-default"><div class="panel-heading"><h3 class="panel-title">Explications de l\'étudiant pour justifier la validation de cette compétence</h3></div><div class="panel-body">'+e.explication+"</div></div>"),t+='<div class="form-group"><label for="explications-validation" class="control-label" id="label"></label><textarea rows="10" class="form-control" id="explicationsValidation"></textarea></div>',d.find(".modal-body #validationUtilisateursModalForm").empty(),d.find(".modal-title").text('Valider la compétence "'+n+'" pour "'+r+'"'),d.find(".modal-body #validationUtilisateursModalForm").append(t),d.find(".modal-body #label").text("En cas de refus, expliquez la raison pour que l'étudiant puisse savoir ce qu'il doit améliorer :")});var p={idCompetence:o,nomCompetence:n,idUtilisateur:l,type:"accepterValidation"};t.click(p,buttonSubmitValidation);var s={idCompetence:o,nomCompetence:n,idUtilisateur:l,type:"refuserValidation"};i.click(s,buttonSubmitValidation)});var $lienPrecedent=null;
function changerNavActive(e){$("#navbar-ul").removeClass("active"),$("#navbar-"+e).addClass("active")}var competencesValidees;$(window).on("load",function(){"use strict";var e=location.search.split("action=")[1];e?"gestion-competences"===e?(changerNavActive(e),$("#arbreGestionCompetences").empty(),$("#arbreGestionCompetences").hide(),$.getJSON("api/competences.php",{type:"getToutesLesCompetences"}).always(function(e){if(""!==e.responseText){$("#arbreGestionCompetences").append('<li id="listeCompetences"><a href="#">Liste des compétences</a>'),$("#listeCompetences").append(genererListeCompetences(0,0,e,"gestionCompetences")),majArbre("#arbreGestionCompetences"),$('[data-toggle="modal"]').tooltip();for(var t=0,s=e.length;s>t;++t){var n=e[t];if(void 0!==n.visible&&!n.visible||n.feuille&&n.visible){var i;i=n.feuille&&n.visible?"setCompetencesInvisibles":"setCompetencesVisibles";var c={idCompetence:n.idCompetence,nomCompetence:n.nomCompetence,visibilite:i};$("#competence-"+n.idCompetence+"-button-visibilite").off(),$("#competence-"+n.idCompetence+"-button-visibilite").click(c,setCompetencesVisibiliteOnClick)}}}$("#loader-competences").hide(),$("#arbreGestionCompetences").show()})):"valider-competences-utilisateurs"===e&&(changerNavActive(e),$("#listeCompetences").empty(),$("#arbreValidationCompetences").hide(),$.getJSON("api/competences.php",{type:"getCompetencesValidation"}).always(function(e){if(e.length>0){$("#listeCompetences").append('<a href="#">Liste des compétences</a>'),$("#listeCompetences").append(genererListeCompetences(0,0,e,"afficherCompetences")),majArbre("#arbreValidationCompetences");for(var t=0,s=e.length;s>t;++t){var n=e[t];if(n.feuille){var i={idCompetence:n.idCompetence,nomCompetence:n.nomCompetence,type:"getUtilisateursCompetence"};$("#competence-"+n.idCompetence).find("a").first().click(i,afficherCompetence)}}}else $("#loader-competences").after("Aucuns étudiants à valider");$("#loader-competences").hide(),$("#arbreValidationCompetences").show()})):(changerNavActive("mes-competences"),$("#listeCompetences").empty(),$("#arbreListeCompetences").hide(),$.getJSON("api/competences.php",{type:"getCompetencesVisiblesSansFeuilles"}).always(function(e){$("#listeCompetences").append('<a href="#">Liste des compétences</a>'),$("#listeCompetences").append(genererListeCompetences(0,0,e,"afficherCompetences")),majArbre("#arbreListeCompetences");for(var t=0,s=e.length;s>t;++t){var n=e[t],i={idCompetence:n.idCompetence,nomCompetence:n.nomCompetence,type:"sousCompetences"};$("#competence-"+n.idCompetence).find("a").first().click(i,afficherCompetence)}$("#loader-competences").hide(),$("#arbreListeCompetences").show()}),$.getJSON("api/competences.php",{type:"estConnecte"},function(e){var t=e.estConnecte;t&&($("#listeCompetencesValidees").empty(),$("#arbreListeCompetencesValidees").hide(),$.getJSON("api/competences.php",{type:"getCompetencesValides"}).always(function(e){e.length>0?(competencesValidees=e,$("#arbreListeCompetencesValidees").append('<li id="listeCompetencesValidees"><a href="#">Liste des compétences validées</a>'),$("#listeCompetencesValidees").append(genererListeCompetences(0,0,e,"afficherCompetences")),majArbre("#arbreListeCompetencesValidees")):$("#panel-body-competences-validees").append("<p>Aucunes compétences validées</p>"),$("#loader-competences-validees").hide(),$("#arbreListeCompetencesValidees").show()}))}))});